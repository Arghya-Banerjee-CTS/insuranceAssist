<div class="container mt-4 p-4 rounded-lg shadow-lg bg-white">
  <!-- Title -->
  <h3 class="text-xl font-semibold mb-4 text-gray-800">Claim History</h3>

  <!-- Filters Row -->
  <div class="mb-3 d-flex justify-content-between flex-wrap align-items-center gap-2">

    <!-- Status Filters -->
    <div class="d-flex flex-wrap gap-2">
      <button class="btn"
              [ngClass]="activeStatusList.includes('CREATED') ? 'btn-primary text-white' : 'btn-outline-primary'"
              (click)="filterByStatus('CREATED')">Created</button>

      <button class="btn"
              [ngClass]="activeStatusList.includes('IN REVIEW') ? 'btn-warning text-white' : 'btn-outline-warning'"
              (click)="filterByStatus('IN REVIEW')">In Review</button>

      <button class="btn"
              [ngClass]="activeStatusList.includes('APPROVED') ? 'btn-success text-white' : 'btn-outline-success'"
              (click)="filterByStatus('APPROVED')">Approved</button>

      <button class="btn"
              [ngClass]="activeStatusList.includes('REJECTED') ? 'btn-danger text-white' : 'btn-outline-danger'"
              (click)="filterByStatus('REJECTED')">Rejected</button>
    </div>

    <!-- Claim Type Filters -->
    <div class="d-flex flex-wrap gap-2">
      <button class="btn" 
              [ngClass]="activeTypeList.includes('PRE') ? 'btn-warning text-dark' : 'btn-outline-warning'" 
              (click)="filterByType('PRE')">PRE</button>
      <button class="btn" 
              [ngClass]="activeTypeList.includes('POST') ? 'btn-info text-dark' : 'btn-outline-info'" 
              (click)="filterByType('POST')">POST</button>
    </div>

    <!-- Date Range Filter -->
    <div class="d-flex align-items-center gap-2">
      <label class="fw-semibold">From:</label>
      <input type="date" [(ngModel)]="filterStartDate" (change)="applyFilters()" 
             class="form-control form-control-sm" style="width:auto;">
      <label class="fw-semibold">To:</label>
      <input type="date" [(ngModel)]="filterEndDate" (change)="applyFilters()" 
             class="form-control form-control-sm" style="width:auto;">
    </div>

    <!-- Clear Filters -->
    <div>
      <button class="btn btn-sm btn-outline-danger" (click)="resetFilters()" title="Clear Filters">âœ–</button>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="mb-3">
    <input type="text"
           [(ngModel)]="filterSearchTerm"
           placeholder="Search claims..."
           class="form-control"
           (input)="applyFilters()">
  </div>

  <!-- Table -->
  @if (!result) {
    <div class="alert alert-info rounded shadow-sm">
      No claims loaded yet.
    </div>
  }
  @else {
    <div class="overflow-x-auto">
      <table class="table table-bordered table-hover table-striped align-middle">
        <thead class="table-dark">
          <tr>
            <th scope="col">Open Date</th>
            <th scope="col">Procedure Notes</th>
            <th class="text-center" scope="col">Claim Type</th>
            <th class="text-center" scope="col">Status</th>
            <th scope="col">Claim Amount</th>
          </tr>
        </thead>
        <tbody>
          @for (c of result; track c.claimId) {
            <tr>
              <td>{{ c.openDate | date:'dd MMMM yyyy' }}</td>
              <td>{{ c.procedureNotes }}</td>

              <!-- Claim Type -->
              <td class="text-center">
                <span class="badge"
                      [ngClass]="{
                        'bg-warning': c.claimType === 'PRE',
                        'bg-info': c.claimType === 'POST'
                      }">
                  {{ c.claimType }}
                </span>
              </td>


              <!-- Status -->
              <td class="text-center">
                <span class="badge"
                  [ngClass]="{
                    'bg-primary': c.status === 'CREATED',
                    'bg-success': c.status === 'APPROVED',
                    'bg-danger': c.status === 'REJECTED',
                    'bg-warning': c.status === 'IN REVIEW'
                  }">
                  {{ c.status }}
                </span>
              </td>

              <td>Rs.{{ c.claimAmount }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
